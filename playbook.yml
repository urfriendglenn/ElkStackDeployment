---
- hosts: all
  become: true
  roles:
    - docker

- hosts: elk
  become: true
  roles:
    - elk

- name: Wait for Elk port 9200 to be open
  wait_for:
    host: 10.1.0.4
    port: 9200
    delay: 60
    state: drained

- hosts: webservers
  become: true
  roles:
    - web
    - filebeat
    - metricbeat